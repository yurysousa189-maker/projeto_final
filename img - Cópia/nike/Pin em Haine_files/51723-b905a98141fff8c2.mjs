(self.modernJsonp=self.modernJsonp||[]).push([["51723"],{95664:function(e,a,n){n.d(a,{$K:()=>i,dh:()=>t,ry:()=>o,xX:()=>r});let t=e=>/instagram/i.test(e||""),o=e=>t(e)||/facebook/i.test(e||"")||/line/i.test(e||"")||/wechat/i.test(e||""),l="[Pinterest/Android]",i=e=>(e||"").includes("[Pinterest/iOS]")||(e||"").includes(l),r=e=>(e||"").includes(l)},79271:function(e,a,n){n.d(a,{Fw:()=>w,OC:()=>m,ZP:()=>b});var t=n(667294),o=n(230201),l=n(589172),i=n(609252),r=n(774838),s=n(739405),d=n(281213),u=n(358198),_=n(2061),p=n(767415),c=n(177433);let g=0,m=()=>g,h={ActivationCard:{impressionType:"activationCardImpressions",idType:"experienceIdStr",eventType:8547},Article:{impressionType:"articleImpressions",idType:"articleIdStr",eventType:3829},Banner:{impressionType:"bannerImpressions",idType:"userIdStr",eventType:9061},Board:{impressionType:"boardImpressions",idType:"boardIdStr",eventType:3700},Comment:{impressionType:"commentImpressions",idType:"commentIdStr",eventType:9127},Guide:{impressionType:"guideImpressions",idType:"term",eventType:7573},Interest:{impressionType:"topicImpressions",idType:"topicIdStr",eventType:3703},News:{impressionType:"newsHubData",idType:"newsIdStr",eventType:4110},OneBar:{impressionType:"oneBarImpressions",idType:"onebarIdStr",eventType:9993},Pin:{impressionType:"pinImpressions",idType:"pinIdStr",eventType:18},Search:{impressionType:"searchImpressions",idType:"term",eventType:3803},Story:{impressionType:"storyImpression",idType:"idStr",eventType:170},TodayArticle:{impressionType:"todayArticleImpressions",idType:"todayArticleIdStr",eventType:8569},User:{impressionType:"userImpressions",idType:"userIdStr",eventType:3704},AdsPreview:{impressionType:"AdsPreviewImpression",idType:"AdsPreviewStr",eventType:8600},BoardMoreIdeasRep:{impressionType:"boardMoreIdeasFeedUpsellImpressions",idType:"boardIdStr",eventType:10054},Notification:{impressionType:"notificationDetailImpressions",idType:"newsIdStr",eventType:4111},NotificationFeed:{impressionType:"notificationFeedImpressions",idType:"newsIdStr",eventType:4110},EditorialBoard:{impressionType:"editorialBoardImpressions",idType:"boardIdStr",eventType:3700},VaseAnnotation:{impressionType:"vaseAnnotationImpressions",idType:"vaseAnnotationUrlStr",eventType:16444}},S=({events:e,startTime:a,endTime:n})=>e?.filter(e=>e>=a&&e<=n)||[];function b({carouselData:e,closeupImpressionType:a,closeupNavigationType:n,componentType:m,contextLogData:b,clientTrackingParams:w,duploShouldTrackPinEvents:y,elementType:v,impressionAuxFields:O,inImpressionExp:I,impressionType:C,impressionsFramework:E,isPaused:P,loggingId:L,objectIdStr:T,slotIndex:f,trackCarousel:N,viewData:U,viewParameter:M,viewType:k,isPromoted:x,storyPinProductEventData:R}){let{logContextEvent:D}=(0,o.u)(),{logMrcVideoAdEventOnPlay:A}=(0,d.H)(),{addImpression:G}=(0,u.WW)()||{},{logStat:F}=(0,_.Yg)(),q=E||i.Z,W=(0,t.useRef)(null),B=(0,t.useRef)(e=>{});B.current=t=>{let o=h[C],l=o.idType,i={clientTrackingParams:w,endTime:t.endTime,[l]:L,slotIndex:f,time:t.startTime,renderDuration:t.endTime-t.startTime,type:a,...O,forcedExit:"removed"===t.forcedExit?0:void 0};if("Pin"===C){g+=1;let e=[],a=t.visibleEvents||new Map,n=t.hiddenEvents||new Map;(O&&O.isPromoted||x)&&[1,50,80,2,102].forEach(o=>{let l=S({events:a.get(o),startTime:t.startTime,endTime:t.endTime}),i=S({events:n.get(o),startTime:t.startTime,endTime:t.endTime});l.forEach(a=>{e.push({type:o,time:a||0,visible:!0})}),i.forEach(a=>{e.push({type:o,time:a||0,visible:!1})})}),i={...i,pinCellWidth:t.pinCellWidth||0,pinCellHeight:t.pinCellHeight||0,windowWidth:window?.innerWidth,windowHeight:window?.innerHeight,visibleEvents:e.sort((e,a)=>e.time-a.time)},O?.nearDupSignature&&G&&m&&[13007,13176,68].includes(m)&&G(O.nearDupSignature)}let r={component:m,object_id_str:T,view_type:k,view_data:U||{},view_parameter:M};if(N)e&&N&&D({event_type:7352,event_data:{pinCarouselSlotImpressions:[{...i,..."canonical"===e.type?{carouselDataId:Number(e.carouselId??0),slotIndex:e.index,carouselSlotId:e.carouselSlots?.[e.index??0]&&Number(e.carouselSlots[e.index??0].slotId)}:{carouselDataId:Number(e.id??0),carouselSlotId:e.carousel_slots?.[e.index??0]&&Number(e.carousel_slots[e.index??0].id),slotIndex:e.index}}]},...r,aux_data:{...b}});else{let e={clientTrackingParams:w,event_type:o.eventType,...r,element:v,event_data:{[o.impressionType]:"Story"===C?i:[i],...R?{storyPinProductEventData:R}:{}},aux_data:{closeup_navigation_type:n,...b}};D(e),A(e)}y&&F("log_pin_impression")};let{expName:H,group:V}=(0,l.Z)({skipActivation:!0}),$=(0,s.ZP)(),K=(0,c.Zv)(),{isAuthenticated:Q}=(0,r.B)(),Z=(0,t.useCallback)(()=>{let e=!1;try{let{current:a}=W;if(a instanceof HTMLElement&&(!x||a.getElementsByTagName("img").length>0)){let n=q.start(a);n.onExitViewport(B.current).setDebugId(L||"unknown"),y&&n.onEnterViewport(()=>{F("log_pin_impression_track_enter_viewport")}),e=!0,V&&(0,p.nP)("webapp.masonry.trackImpression",{tags:{callsite:"app_packages_useImpressionTracker",deviceType:$,experimentName:H,group:V,handlerId:K,isAuthenticated:Q,slotIndex:f??"unknown"}})}}catch{window.console.error('Can only track impressions for type "HTMLElement"')}y&&F("log_pin_impression_track",{didStartTracking:e})},[W.current]);return(0,t.useEffect)(()=>(I&&!q.inExperiment&&q.setExperimentStatus(!0),P||Z(),()=>{let{current:e}=W;e instanceof HTMLElement&&(!x||e.getElementsByTagName("img").length>0)&&q.stop(e)}),[P,Z]),W}let w=({children:e,...a})=>e({impressionTrackerRef:b(a)})},331357:function(e,a,n){n.d(a,{J:()=>l,U:()=>m});var t=n(27399),o=n(767415);let l="nic_v4",i=`${l}=1a`,r=`${l}=1b`,s=[i,r],d=["invite_code","invite","board_invite_code","sender"],u=null,_=e=>!!d.find(a=>e.includes(a)),p=e=>{let a;return e.pathname.includes("/pin/")&&!_(e.search)&&(a=e.search,!s.find(e=>a.includes(e)))},c=async e=>{let{resource_response:a}=await t.Z.create("InviteSocialTrackingParamNonInviteResource",{user_id:e}).callCreate();if(!a)return(0,o.nP)(`${l}.social_tracking_pin_non_invite.no_resource_response`),"";{let e=encodeURIComponent(a.data);return(0,o.nP)(`${l}.social_tracking_pin_non_invite.encrypted.${e?"true":"false"}`),e}},g=(e,a,n=!1,t)=>{if(!p(e))return;let s=n?"mweb":"web";if(!a)return void(0,o.nP)(`${s}.${l}.social_tracking_pin_non_invite.insert.no_encrypted_id`);(0,o.nP)(`${s}.${l}.social_tracking_pin_non_invite.insert.attempt`);try{let d=((e,a,n)=>{let t=e.search?"&":"?";return e.pathname+e.search+(t+(n?r:i)+a)})(e,a,n||!1);(0,o.nP)(`${s}.${l}.social_tracking_pin_non_invite.insert.success`),t(d)}catch{(0,o.nP)(`${s}.${l}.social_tracking_pin_non_invite.insert.caught_exception`)}},m=(e,a,n,t,i)=>{let r=n?"mweb":"web";(0,o.nP)(`${r}.${l}.social_tracking_pin_non_invite.attempt`);try{let s;!n&&t&&p(e)?((0,o.nP)(`${r}.${l}.social_tracking_pin_non_invite.search_string_eligible`),((e,a,n=!1,t)=>{u?g(e,u,n,t):(async()=>{let o=await c(a);u=o,g(e,o,n,t)})()})(e,a,n,i)):(s=e.search,!_(s)&&!s.includes("sender")&&s.includes(l)&&(0,o.nP)(`${r}.${l}.social_tracking_pin_non_invite.search_string_land`))}catch{(0,o.nP)(`${r}.${l}.social_tracking_pin_non_invite.caught_exception`)}}},456871:function(e,a,n){n.d(a,{Z:()=>_});var t=n(312048),o=n(331357),l=n(173874),i=n(774838),r=n(843716),s=n(900907),d=n(986523),u=n(767415);function _(){let e,{isBot:a,isSocialBot:n,referrerFromCookie:_,referrerFromHeader:p,countryFromHostName:c,countryFromIp:g,regionFromIp:m,isAuthenticated:h}=(0,i.B)(),S=(0,t.TH)(),b=(0,d.Z)(),w=new URLSearchParams(S.search),y=!a&&!!w.get("utm_pai"),v=w.get("utm_source"),O=!a&&!n&&(0,l.hasInviteCode)(S),I=(0,s.Z)({countryFromHostName:c||"",countryFromIp:g||"",regionFromIp:m||"",isAuthenticated:h}),C=p||I&&_||"";e=b||!I?C:(0,r.an)(C);let E=!1,P=!a&&!n&&v&&["email",String(31)].includes(v),L=!a&&!n&&v&&["fb"].includes(v),T="offsite"===v,f=!a&&!n&&!!(e&&(/facebook/.test(e)||/fb/.test(e))),N=!a&&!n&&!!(e&&(/twitter/.test(e)||/tw/.test(e)));O&&(0,u.nP)("unauth.entry_channel.invite_code",{sampleRate:1}),P&&(0,u.nP)("unauth.entry_channel.email_utm_source",{sampleRate:1}),L&&(0,u.nP)("unauth.entry_channel.social_media_utm_source_fb",{sampleRate:1}),T&&(0,u.nP)("unauth.entry_channel.offsite_utm_source",{sampleRate:1}),f&&(0,u.nP)("unauth.entry_channel.social_media_referer_fb",{sampleRate:1}),N&&(0,u.nP)("unauth.entry_channel.social_media_referer_twitter",{sampleRate:1}),E=(0,r.Xn)(e);let U=!a&&E,M=!!w.get(o.J),k=!!w.get("twa_type")||e&&e.startsWith("android-app://com.pinterest.twa"),x=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","utm_admin","utm_id","utm_mail","utm_swu"].some(e=>null!==w.get(e))||!!e||M||k;return{isPaid:y,isInvite:O,utmSource:v,referrer:e,isSocial:O,isDirect:!a&&!y&&!O&&!U&&!x,isSEO:U,isBrowserStorageAllowed:I,isOffsite:T,isBot:a||n}}},843716:function(e,a,n){n.d(a,{Xn:()=>m,Yf:()=>w,an:()=>h});var t=n(173874),o=n(138482),l=n(575820);let i="BING",r="GOOGLE",s="YAHOO",d="YANDEX",u="RAKUTEN",_="NAVER",p="AMP_CACHE",c="DUCKDUCKGO",g=[r,i,s,d,u,_,p,c];function m(e){return g.includes(function(e){let{hostname:a}=(0,l.Qc)(e,!0);if(a&&e){if(a.includes("google.")||e.includes("android-app://com.google.android.googlequicksearchbox"))return r;else if(a.includes("bing."))return i;else if(a.includes("yahoo."))return s;else if(a.includes("yandex."))return d;else if(a.includes("rakuten."))return u;else if(a.includes("naver."))return _;else if(a.includes("duckduckgo."))return c;else if(a.includes(".cdn.ampproject.org"))return p}return""}(e))}function h(e){return e||"undefined"!=typeof document&&document.referrer||""}let S=e=>"/"!==e[e.length-1]?`${e}/`:e,b=e=>{let a=S(e),n=(0,t.createRouterLocation)({url:a});return(0,t.isCloseupPage)(n)?"PIN":(0,t.isBoardPage)(n)?"BOARD":(0,o.Z)(n)?"PROFILE":(0,t.isAnyTodayPage)(n)?"TODAY":(0,t.isAnyIdeasPage)(n)?"IDEA":(0,t.isAnyShoppingPage)(n)?"SHOPPING":"UNKNOWN"},w=({country:e,language:a,isBot:n,hostname:t,pathname:o})=>({domain:t,country:e,language:a,currentUrl:o,pageType:b(o),referrer:document.referrer,isBot:n,links:(({selector:e,skipExternal:a})=>{let n=Array.from(document.querySelectorAll(e)),t={pin:[],board:[],user:[],today:[],idea:[],shopping:[]},o=new Set;return n.forEach(e=>{let n=e.getAttribute("href");if(!n||n.startsWith("#")||a&&n.startsWith("http")&&!n.includes(window.location.hostname))return;let l=S(n);if(o.has(l))return;o.add(l);let i=b(l);"PIN"===i?t.pin.push(l):"BOARD"===i?t.board.push(l):"PROFILE"===i?t.user.push(l):"TODAY"===i?t.today.push(l):"IDEA"===i?t.idea.push(l):"SHOPPING"===i&&t.shopping.push(l)}),t})({selector:"a[href]",skipExternal:!0})})},434291:function(e,a,n){n.d(a,{m:()=>o,r:()=>l});var t=n(815271);function o(e,a){(0,t.Z)("ðŸŽ¯ ENGAGEMENT_SCORE_CALCULATED",{trigger:e,...a})}function l(e,a){(0,t.Z)("desktop"===e?"DESKTOP_UPSELL_DECISION":"MOBILE_UPSELL_DECISION",a)}},116412:function(e,a,n){n.d(a,{U:()=>o,a:()=>l});var t=n(935833);function o({PES:e,NUS:a,conversionIntentLevel:n,triggerAction:o,deviceType:l}){(0,t.My)("engagement_score.calculated",{engagement_score:e,upsell_negative_score:a,user_intent_bucket:n,upsell_type_tag:"conversion",trigger_action:o,device_type:l})}function l({upsellType:e,decision:a,intentLevel:n,PES:o,NUS:l,experimentVariant:i}){(0,t.My)("upsell.decision_with_intent",{upsell_type:e,decision:a,intent_level:n,pes:o,nus:l,experiment_variant:i})}},184285:function(e,a,n){n.d(a,{HZ:()=>b,ZP:()=>f,e_:()=>T,pT:()=>I});var t=n(667294),o=n(581722),l=n(312048),i=n(15881),r=n(95664),s=n(79271),d=n(456871),u=n(774838),_=n(418282),p=n(270922),c=n(739405),g=n(658375),m=n(767415);let h=Date.now(),S=()=>(0,o.v9)(e=>e.upsell?.mWebSignupModal.modal.isShown??!1),b=()=>(0,o.v9)(e=>e.upsell?.modal),w=()=>(0,s.OC)(),y=()=>Date.now()-h,v=()=>(0,o.v9)(e=>e.upsell?.mWebSignupModal.isUnauthSharingModalsShown??!1),O=()=>(0,o.v9)(e=>!!e.upsell?.mWebSignupModal.modalHasShown),I=()=>(0,o.v9)(e=>e.upsell?.mWebSignupModal),C=()=>{let e=(0,u.B)(),a=(0,d.Z)(),n=(0,c.ZP)(),o=(0,l.TH)();return(0,t.useMemo)(()=>(0,p.T9)(e,a,n,o.pathname),[e,a,n,o.pathname])},E=Object.freeze(["CO","ID"]),P=e=>E.includes(e),L=e=>{if(!(0,r.ry)(e))return!1;let a=(0,_.Nl)();return a.getItem(i.QV)||((0,m.nP)("mobile_signup_modal.rules.suppress_for_social_in_app_browser"),a.setItem(i.QV,"1")),!0},T=({isModalShown:e,isUnauthSharingModalsShown:a,modalHasShown:n,country:t,userAgent:o})=>!e&&!(a||n&&P(t)||(0,g.P)()||L(o));function f(){let e=S(),a=(0,o.v9)(e=>e.upsell?.mWebSignupModal.modal),n=(0,o.v9)(e=>e.upsell?.mWebSignupModal.upsellEligibleNavigationCount),l=v();return{isModalShown:e,modal:a,upsellEligibleNavigationCount:n,isUnauthSharingModalsShown:l,modalHasShown:O(),sessionContext:C(),isUpsellEnabledGlobally:(()=>{let e=S(),a=v(),n=O(),o=C();return(0,t.useCallback)(()=>!e&&!(({isUnauthSharingModalsShown:e,modalHasShown:a,sessionContext:n})=>{if(!n)return!1;let{country:t,userAgent:o}=n;return e||a&&P(t)||(0,g.P)()||L(o)})({isUnauthSharingModalsShown:a,modalHasShown:n,sessionContext:o}),[e,a,n,o])})(),getPinImpressionCount:w,getSessionDuration:y}}},432414:function(e,a,n){n.d(a,{ZW:()=>P,Gk:()=>E,YM:()=>L});var t=n(173874),o=n(138482),l=n(434291),i=n(116412),r=n(730056);let s="dweb_eoq_q3_standard",d="dweb_eoq_q3_advanced",u="mweb_eoq_q3_standard",_="mweb_eoq_q3_advanced",p="mweb_eoq_q4_advanced_ucan",c="mweb_eoq_q4_emergency_ucan",g="mweb_eoq_q4_advanced_non_ucan",m="mweb_eoq_q4_emergency_non_ucan",h="dweb_eoq_q4_advanced_ucan",S="dweb_eoq_q4_emergency_ucan",b="dweb_eoq_q4_advanced_non_ucan",w="dweb_eoq_q4_emergency_non_ucan",y=[{bundleId:"dweb_eoq_q3_standard",experimentKey:s,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}}}},{bundleId:"dweb_eoq_q3_advanced",experimentKey:d,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"mweb_eoq_q3_standard",experimentKey:u,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}}}},{bundleId:"mweb_eoq_q3_advanced",experimentKey:_,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_advanced_ucan",experimentKey:p,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_emergency_ucan",experimentKey:c,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0},seo:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_advanced_non_ucan",experimentKey:g,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_emergency_non_ucan",experimentKey:m,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0},seo:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"dweb_eoq_q4_advanced_ucan",experimentKey:h,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"dweb_eoq_q4_advanced_non_ucan",experimentKey:b,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"dweb_eoq_q4_emergency_ucan",experimentKey:S,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:0}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"dweb_eoq_q4_emergency_non_ucan",experimentKey:w,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:0}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}}];function v(e,a){let n=y.filter(n=>{if(!n.active||!n.overrides[e])return!1;switch(n.experimentKey){case s:return a("dweb_eoq_q3_standard").anyEnabled;case d:return a("dweb_eoq_q3_advanced").anyEnabled;case u:return a("mweb_eoq_q3_standard").anyEnabled;case _:return a("mweb_eoq_q3_advanced").anyEnabled;case p:return a("mweb_eoq_q4_advanced_ucan").anyEnabled;case c:return a("mweb_eoq_q4_emergency_ucan").anyEnabled;case g:return a("mweb_eoq_q4_advanced_non_ucan").anyEnabled;case m:return a("mweb_eoq_q4_emergency_non_ucan").anyEnabled;case h:return a("dweb_eoq_q4_advanced_ucan").anyEnabled;case S:return a("dweb_eoq_q4_emergency_ucan").anyEnabled;case b:return a("dweb_eoq_q4_advanced_non_ucan").anyEnabled;case w:return a("dweb_eoq_q4_emergency_non_ucan").anyEnabled;default:return!1}});return n[n.length-1]?.overrides[e]}let O=e=>({id:e.id,evaluate:function({ruleId:e,baseEvaluateFunction:a}){return n=>{let{checkExperiment:t,session:o}=n,l=t&&v(e,t)?.evaluateContextOverride||{},i=l[o?.channel??"default"]||l.default||{};return a((0,r.Z)(n,i))}}({ruleId:e.id,baseEvaluateFunction:e.evaluate}),getNextState:function({ruleId:e,baseNextStateFunction:a}){return({action:n,state:t,decision:o})=>{let l=a({action:n,state:t,decision:o});if(!("payload"in n&&"object"==typeof n.payload&&null!==n.payload&&"checkExperiment"in n.payload))return l;let i=v(e,n.payload.checkExperiment)?.stateOverride||{};return 0===Object.keys(i).length?l:(0,r.Z)(l,i)}}({ruleId:e.id,baseNextStateFunction:e.getNextState})});var I=n(671220);let C=(e,a)=>{let n={enabled_1:["high","medium"],enabled_2:["high"],enabled_3:["medium"],enabled_4:["medium","low"]}[a];return!!n&&n.includes(e||"unknown")},E={shouldShowRelatedPinsGradientUpsell:O({id:"desktop_related_pins_gradient_upsell_trigger",evaluate:({relatedPinsGradientUpsellEverShown:e,checkExperiment:a})=>{if(e)return!1;let n=a?.("ce_dweb_unauth_related_pins_limit");return!!n?.anyEnabled},getNextState:({state:e})=>({...e,showRelatedPinsGradientUpsell:!0,relatedPinsGradientUpsellEverShown:!0})}),shouldShowCloseupNavigationalModal:O({id:"closeup_navigational_modal_trigger",evaluate:({pinViewCount:e,navigationalPagesUpsellSeen:a,checkExperiment:n})=>!n?.("pc_no_navigational_upsell").anyEnabled&&(e??0)>=4&&!a,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"navigation_1",container:"closeup",reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})}),shouldShowSaveModal:O({id:"save_modal_trigger",evaluate:()=>!0,getNextState:({action:e,state:a})=>({...a,pinSaveCount:a.pinSaveCount+1,pinId:e.payload.pinId,attributionLabel:e.payload.attributionLabel,showSaveModal:!0,modal:{isShown:!0,displayProps:{attributionLabel:e.payload.attributionLabel,container:"save",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",savePinId:e.payload.pinId,signupFlow:{type:"signup"},source:"saveButtonExp"}}})}),shouldShowNavigationalModal:O({id:"desktop_navigational_modal_trigger",evaluate:({uniqueNavigationalPagesSeen:e=[],navigationalPagesUpsellSeen:a,navigationalPagesViewThresholdDesktop:n,checkExperiment:t})=>!t?.("pc_no_navigational_upsell").anyEnabled&&e.length>=(n??4)&&!a,getNextState:({state:e,action:a})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:`navigation_${a.payload.containerPage}`,container:a.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})}),shouldShowNavigationalModalIntentBased:O({id:"desktop_navigational_modal_intent_trigger",evaluate:({navigationalPagesUpsellSeen:e,engagementScore:a,checkExperiment:n})=>{let t=n?.("engagement_score_v0_dweb");if(!t?.anyEnabled||e)return!1;let{conversionIntentLevel:o,PES:r,NUS:s}=a||{},d=C(o,t.group);return(0,l.r)("desktop",{variant:t.group,decision:d?"SHOW":"SKIP",intentLevel:o,PES:r||0,NUS:s||0,reason:d?`Intent ${o} in allowed list`:`Intent ${o} NOT in allowed list`}),(0,i.a)({upsellType:"navigation_desktop",decision:d?"show":"skip",intentLevel:o||"unknown",PES:r||0,NUS:s||0,experimentVariant:t.group}),d},getNextState:({state:e,action:a})=>{let{conversionIntentLevel:n,PES:t,NUS:o}=e.engagementScore||{};return{...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:`navigation_intent_${n}_pes_${t||0}_nus_${o||0}`,container:a.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0}}}),shouldShowSignupModalOnCloseUpClick:O({id:"closeup_modal_trigger",evaluate:({modal:e,clickCloseUp:a})=>!e?.isShown&&!a,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_closeup",container:"pinWash",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickCloseUp:!0})}),shouldShowSignupModalOnClickContextMenuSaveButton:O({id:"context_menu_save_button_trigger",evaluate:({modal:e,clickContextMenuSaveButton:a})=>!e?.isShown&&!a,getNextState:({action:e,state:a})=>{let n;return n=["enabled_all_improved","enabled_all","enabled_save"].includes(e.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===e.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:e.payload.pinId},{...a,modal:{isShown:!0,displayProps:n},clickContextMenuSaveButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}}),shouldShowSignupModalOnClickCloseupSaveButton:O({id:"closeup_save_button_trigger",evaluate:({modal:e,clickCloseUpContextMenuSaveButton:a})=>!e?.isShown&&!a,getNextState:({action:e,state:a})=>{let n;return n=["enabled_all_improved","enabled_all","enabled_save"].includes(e.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===e.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:e.payload.pinId},{...a,modal:{isShown:!0,displayProps:n},clickCloseUpContextMenuSaveButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}}),shouldShowSignupModalOnContextMenuDownloadClick:O({id:"desktop_context_menu_download_button_trigger",evaluate:({limitReached:e,inImmediateUpsellGroup:a,modal:n})=>!!((e||a)&&!n?.isShown),getNextState:({action:e,state:a})=>{let n;return n=e.payload.inDwebSwapDownloadUpsellExp?{signupFlow:{type:"login"},attributionLabel:`click_${e.payload.attributionLabelSource}_download_button`,container:"lopDownloadUpsell",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"lopDownloadUpsell"}:{signupFlow:{type:"signup"},attributionLabel:`click_${e.payload.attributionLabelSource}_download_button`,container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:e.payload.pinId},{...a,modal:{isShown:!0,displayProps:n},clickContextMenuDownloadButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}}),shouldShowSignupModalOnCloseupDownloadClick:O({id:"closeup_download_button_trigger",evaluate:({limitReached:e,modal:a})=>!!(e&&!a?.isShown),getNextState:({action:e,state:a})=>({...a,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_download_button`,container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:e.payload.pinId}},clickCloseUpContextMenuDownloadButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource})}),shouldShowSignupModalOnFollowButtonClick:O({id:"follow_button_trigger",evaluate:({modal:e,clickFollowButton:a})=>!e?.isShown&&!a,getNextState:({action:e,state:a})=>({...a,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:e.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",container:e.payload.isContextualFollowEnabled?"follow":"",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:e.payload.isContextualFollowEnabled?"followButton":void 0}},clickFollowButton:!0})}),shouldShowSignupModalOnFollowingButtonClick:O({id:"following_button_trigger",evaluate:({modal:e,clickFollowingButton:a})=>!e?.isShown&&!a,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_following",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowingButton:!0})}),shouldShowSignupModalOnFollowersButtonClick:O({id:"followers_button_trigger",evaluate:({modal:e,clickFollowersButton:a})=>!e?.isShown&&!a,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_followers",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowersButton:!0})}),shouldShowLoginModalOnCommentComposerClick:O({id:"comment_composer_trigger",evaluate:({modal:e,clickCommentComposerUpsell:a})=>!e?.isShown&&!a,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"tap_unauth_comment_composer",container:"closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"commentComposer"}},clickCommentComposerUpsell:!0})}),shouldShowLoginModalOnRelatedPinOpenLinkClick:O({id:"related_pin_open_link_trigger",evaluate:({modal:e,clickRelatedPinOpenLinkUpsell:a})=>!e?.isShown&&!a,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"click_context_menu_related_pin_right_click_open_link_button",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickRelatedPinOpenLinkUpsell:!0})}),shouldShowLoginModalOnPinLinkClick:O({id:"pin_link_trigger",evaluate:({modal:e,pinLinkClickCount:a=0})=>!e?.isShown&&(2===a||a%5==0),getNextState:({action:e,state:a})=>({...a,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"pinLinkClickHandler_tier1",container:"hybrid_clickthrough",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickPinLinkCount:e.payload.count})}),shouldShowSocialPinLandingModal:O({id:"social_pin_landing_modal_trigger",evaluate:({inviter:e,socialPinLandingModalShown:a,checkExperiment:n})=>{if(!e||a)return!1;let t=n?.("ce_dweb_unauth_splp_blocking").anyEnabled,o=n?.("ce_dweb_unauth_splp_blocking_no_delay").anyEnabled,l=n?.("ce_dweb_unauth_splp_blocking_3s").anyEnabled;return!!(t||o||l)},getNextState:({action:e,state:a})=>({...a,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:e.type===I.Fy?`delay_${e.payload.containerPage}`:`scroll_${e.payload.containerPage}`,container:e.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},socialPinLandingModalShown:!0})}),shouldShowScrollingBox:{id:"desktop_scrolling_box_trigger",evaluate:({checkExperiment:e})=>!e?.("pc_no_navigational_upsell").anyEnabled,getNextState:({state:e})=>e}},P={shouldShowSaveEducationPopover:O({id:"mobile_save_education_popover_trigger",evaluate:({saveEducationPopoverEverShown:e,checkExperiment:a})=>{if(e)return!1;let{group:n}=a?.("ce_mweb_unauth_social_feature_education")||{};return!!n?.startsWith("enabled_group_board")},getNextState:({state:e})=>({...e,showSaveEducationPopover:!0,saveEducationPopoverEverShown:!0})}),shouldShowReplyToSenderSheet:O({id:"mobile_reply_to_sender_sheet_trigger",evaluate:({replyToSenderSheetEverShown:e,checkExperiment:a})=>{if(e)return!1;let{group:n}=a?.("ce_mweb_unauth_social_feature_education")||{};return!!n?.startsWith("enabled_reply_to_sender")},getNextState:({state:e})=>({...e,showReplyToSenderSheet:!0,replyToSenderSheetEverShown:!0})}),shouldAllowUnauthSave:O({id:"mobile_unauth_save_quota_check",evaluate:({isPPMAndroidUnauthExperience:e,isFromUnauthContextMenu:a,currentUnauthSaves:n=0,mobileUnauthSaveThreshold:t})=>!a&&!e&&n<(t??2),getNextState:({action:e,state:a})=>({...a,mWebSignupModal:{...a.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(a.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:a.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:e.payload.headingType,trigger:{attributionLabel:"extended_save_out_of_quota"===e.payload.headingType?"click_save_button_with_max_unauth_saves":e.payload.attributionLabel||"click_save_button_on_closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:e.payload.pinId}}})}),shouldShowMainPinImageNavigationalModal:O({id:"mobile_main_pin_image_modal",evaluate:({checkExperiment:e,isUpsellEnabledGlobally:a,isModalCurrentlyShown:n,learningUpsellScenario:t,forceShowModal:o})=>{let l=t&&a&&!n&&(e?.("mweb_unauth_main_learning_pin_full_page").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced_row").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency_row").anyEnabled||e?.("mweb_q2_mau_push_pc_eu_safe").anyEnabled);return t&&(o||!!l)},getNextState:({action:e,state:a})=>({...a,mWebSignupModal:{...a.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(a.mWebSignupModal?.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:a.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:"none",trigger:{attributionLabel:"navigation_main_pin_image_click",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:e.payload.pinId}}})}),shouldShowMainPinImageAppUpsell:{id:"mobile_main_pin_app_upsell_purple_banner",getNextState:({state:e})=>e,evaluate:({learningUpsellScenario:e,hasConversionUpsell:a,isLearningAppUpsellShown:n})=>a||!e?{shouldToggleAppUpsell:!1,currentlyShowing:!1,newState:!1}:{shouldToggleAppUpsell:!0,currentlyShowing:n,newState:!n}},shouldShowNavigationUpsell:O({id:"mobile_navigation_upsell",evaluate:({isUpsellEnabledGlobally:e,isModalCurrentlyShown:a,newLocation:n,isNavigationFromSwipe:t,currentNavigationCount:o,hasSeenModal:l,pageThreshold:i,isWashDismissible:r,canShowSignupModalOnRouteChange:s,navigationalPagesViewThresholdMobile:d,checkExperiment:u})=>{if(u?.("pc_no_navigational_upsell").anyEnabled)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};let _=d||i||4;if(a)return{shouldShowModal:!1,shouldDismissModal:!0,shouldIncrementCount:!1};if(!(e&&!t)||!(n&&s?.(n)))return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(!((o??0)>=_)||l)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};let p=u?.("mweb_feature_upsell_copy_visual_combination_v2");return{shouldShowModal:!0,shouldDismissModal:!1,shouldIncrementCount:!0,attributionLabel:`navigation_${_}_${o}`,allowCloseOnOutsideClick:r,headingType:p?.anyEnabled?"mweb_feature_upsell_copy_visual_combination_v2":"none"}},getNextState:({state:e,decision:a})=>({...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:a?.headingType??"none",trigger:{attributionLabel:a?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!!a?.allowCloseOnOutsideClick},pinId:null}}})}),shouldShowNavigationUpsellIntentBased:O({id:"mobile_navigation_upsell_intent",evaluate:({isUpsellEnabledGlobally:e,isModalCurrentlyShown:a,newLocation:n,isNavigationFromSwipe:t,hasSeenModal:o,canShowSignupModalOnRouteChange:r,engagementScore:s,checkExperiment:d})=>{let u=d?.("engagement_score_v0_mweb");if(!u?.anyEnabled)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(a)return{shouldShowModal:!1,shouldDismissModal:!0,shouldIncrementCount:!1};if(!e||t||!n||!r?.(n))return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(o)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};let{conversionIntentLevel:_,PES:p,NUS:c}=s||{},g=C(_,u.group);if((0,l.r)("mobile",{variant:u.group,decision:g?"SHOW":"SKIP",intentLevel:_,PES:p||0,NUS:c||0,reason:g?`Intent ${_} in allowed list`:`Intent ${_} NOT in allowed list`}),(0,i.a)({upsellType:"navigation_mobile",decision:g?"show":"skip",intentLevel:_||"unknown",PES:p||0,NUS:c||0,experimentVariant:u.group}),!g)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};let m=d?.("mweb_feature_upsell_copy_visual_combination_v2");return{shouldShowModal:!0,shouldDismissModal:!1,shouldIncrementCount:!0,attributionLabel:`navigation_intent_${_}_pes_${p||0}_nus_${c||0}`,allowCloseOnOutsideClick:!0,headingType:m?.anyEnabled?"mweb_feature_upsell_copy_visual_combination_v2":"none"}},getNextState:({state:e,decision:a})=>({...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:a?.headingType??"none",trigger:{attributionLabel:a?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!!a?.allowCloseOnOutsideClick},pinId:null}}})}),shouldShowOnLandUpsell:O({id:"mobile_on_land_upsell",evaluate:({checkExperiment:e,isUpsellEnabledGlobally:a,hasSeenNavUpsell:n,location:l,userAgent:i,showUnauthMwebSocialDefaultModalUpsell:r,isSocialInAppBrowser:s,shouldTriggerOnLand:d=!1})=>{let u;if(e?.("pc_no_navigational_upsell").anyEnabled||!a||n||!(l&&((0,t.isCloseupPage)(l)||(0,t.isBoardPage)(l)||(0,o.Z)(l)||(0,t.isSearchPage)(l)||(0,t.hasInviteCode)(l))))return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};let _=!(s?.(i)&&e?.("mweb_unauth_social_iab_upsell_boost_experiment",{dangerouslySkipActivation:!0}).anyEnabled)&&r;if(!r&&!d)return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};let p=_?null:e?.("mweb_feature_upsell_copy_visual_combination_v2"),c=p?.anyEnabled??!1;if("social"==(u=_?"social":c?"mweb_feature_upsell_copy_visual_combination_v2":"none")&&e){let a=e("ce_mweb_visual_plp_upsell");if(a.anyEnabled)switch(a.group){case"enabled_1":u="social_visual_1";break;case"enabled_2":u="social_visual_2";break;case"enabled_3":u="social_visual_3"}}return{shouldShowModal:!0,shouldIncrementCount:!0,showUnauthMwebSocialUpsell:_,modalConfig:{reason:"UPSELL_LOGIN_OR_SIGNUP",attributionLabel:"navigation_0",navigationTriggeredUpsell:{newLocation:l,oldLocation:l},headingType:u}}},getNextState:({state:e,decision:a})=>{let{modalConfig:n}=a;return{...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:n?.headingType,trigger:{attributionLabel:n?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:null}}}}}),shouldShowSignupModalOnContextMenuDownloadClick:O({id:"mobile_context_menu_download_button_trigger",evaluate:({limitReached:e,inImmediateUpsellGroup:a,modal:n})=>(e||a)&&!n?.isShown,getNextState:({action:e,state:a})=>{let{inMwebDownloadCTAExp:n,showDownloadCloseupIcon:t,attributionLabelSource:o}=e.payload,l={trigger:{attributionLabel:`click_${o}_download_button`,reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},headingType:n||t?"download_limit_reached":"none"};return{...a,mWebSignupModal:{...a.mWebSignupModal,modal:{isShown:!0,displayProps:l,pinId:e.payload.pinId??""}}}}}),shouldShowSignupModalOnFollowButtonClickMobile:O({id:"follow_button_trigger_mobile",evaluate:({mWebSignupModal:e})=>!e?.modal.isShown,getNextState:({action:e,state:a})=>({...a,mWebSignupModal:{...a.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(a.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:a.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:e.payload.isContextualFollowEnabled?"follow":"none",trigger:{attributionLabel:e.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0}}}})}),shouldShowFloatingBanner:{id:"mobile_floating_banner_trigger",evaluate:({checkExperiment:e})=>!e?.("pc_no_navigational_upsell").anyEnabled,getNextState:({state:e})=>e}},L={desktop:E,mobile:P}},671220:function(e,a,n){n.d(a,{dn:()=>F,UA:()=>Z,ub:()=>ei,EH:()=>ec,Ik:()=>U,qH:()=>ek,mV:()=>A,OU:()=>_,Gh:()=>m,LL:()=>ew,Li:()=>eu,jB:()=>en,G5:()=>eh,CC:()=>eX,F8:()=>eE,Ue:()=>K,kQ:()=>G,h4:()=>$,g_:()=>X,t:()=>ez,rA:()=>M,BF:()=>e_,aj:()=>eV,qD:()=>eR,IS:()=>eK,it:()=>R,Yr:()=>H,Vi:()=>B,by:()=>S,wK:()=>z,i8:()=>v,K7:()=>g,fC:()=>ex,GY:()=>ef,uy:()=>C,HK:()=>w,f$:()=>J,qs:()=>j,vY:()=>ed,yC:()=>eB,Fy:()=>W,QG:()=>O,OX:()=>I,WE:()=>eI,CH:()=>eH,qT:()=>b,Dk:()=>es,Bh:()=>Y,qq:()=>eZ,Nx:()=>P,$S:()=>L,Lu:()=>et,k7:()=>eD,Qm:()=>eW,Pp:()=>f,Sy:()=>el,b9:()=>eS,z1:()=>eo,$y:()=>u,tP:()=>E,Zr:()=>x,sg:()=>ea,QC:()=>eM,Hm:()=>eb,uV:()=>eT,FV:()=>ev,o9:()=>eG,MZ:()=>ej,V9:()=>Q,AS:()=>c,kd:()=>k,pp:()=>p,QA:()=>em,tW:()=>eC,v2:()=>eP,Jw:()=>eY,w$:()=>er,Pu:()=>e$,gU:()=>e0,cD:()=>ey,P9:()=>T,YT:()=>eQ,pZ:()=>eF,dL:()=>eg,XE:()=>eU,Ff:()=>eA,tA:()=>V,TQ:()=>ee,Q4:()=>y,gH:()=>D,aJ:()=>q,C5:()=>ep,Aw:()=>eq,xY:()=>eO,Dw:()=>eJ,Bi:()=>N,ap:()=>eL,ht:()=>eN,mX:()=>h});var t=n(95664),o=n(935833),l=n(184285),i=n(432414);let r=e=>{let{modal:a,mWebSignupModal:n,appUpsells:t}=e;return!!(a.isShown||n.modal.isShown||t.learningUpsell?.isShown||t.iabAppUpsell?.isShown)};var s=n(932921),d=n(767415);let u="PROCESS_MOBILE_NAVIGATION_CHANGE",_="SET_UPSELL_REASON",p="UPS_EVENT_PIN_VIEW",c="UPS_EVENT_PIN_SAVE",g="UPS_EVENT_DESKTOP_MODAL_SHOW",m="UPS_EVENT_DESKTOP_MODAL_DISMISSED",h="CLICK_CLOSE_UP_CONTEXT_MENU_SAVE_BUTTON",S="CLICK_CLOSE_UP_CONTEXT_MENU_DOWNLOAD_BUTTON",b="TRIGGER_SCROLL_DOWN_UPSELL",w="CLEAR_SCROLL_DOWN_UPSELL",y="DISMISS_BOTTOM_RIGHT_BANNER",v="TRIGGER_SAVE_EDUCATION_POPOVER",O="CLEAR_SAVE_EDUCATION_POPOVER",I="TRIGGER_RELATED_PINS_GRADIENT_UPSELL",C="CLEAR_RELATED_PINS_GRADIENT_UPSELL",E="TRIGGER_REPLY_TO_SENDER_SHEET",P="CLEAR_REPLY_TO_SENDER_SHEET",L="CLICK_CLOSEUP_UPSELL",T="CLICK_CONTEXT_MENU_SAVE_BUTTON_UPSELL",f="CLICK_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",N="CLICK_FOLLOW_BUTTON_UPSELL",U="CLICK_FOLLOWING_BUTTON_UPSELL",M="CLICK_FOLLOWERS_BUTTON_UPSELL",k="CLICK_COMMENT_COMPOSER_UPSELL",x="CLICK_PIN_LINK_UPSELL",R="CLICK_RELATED_PIN_OPEN_LINK_UPSELL",D="RECORD_NAVIGATIONAL_PAGE",A="SET_INITIAL_SESSION_CONTEXT",G="UPDATE_LATEST_L1_VERTICAL",F="RESET_UPSELL_TRIGGER_STATE",q="RECORD_SOCIAL_PIN_LANDING_PAGE",W="TRIGGER_SOCIAL_DELAY_MODAL",B="TRIGGER_SOCIAL_SCROLL_MODAL",H="SHOW_MOBILE_SIGNUP_MODAL",V="DISMISS_MOBILE_SIGNUP_MODAL",$="SET_MOBILE_SIGNUP_MODAL_TOP_INTEREST",K="INCREMENT_UPSELL_ELIGIBLE_NAVIGATION_COUNT",Q="HIDE_UNAUTH_SHARING_MODALS",Z="SHOW_UNAUTH_SHARING_MODALS",Y="RESTORE_FROM_LOCAL_STORAGE",X="MAIN_PIN_IMAGE_CLICK_MOBILE",j="ON_LAND_UPSELL_MOBILE",J="SET_LEARNING_UPSELL_VISIBILITY",z="CLICK_MOBILE_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",ee="DISMISS_MOBILE_FLOATING_UPSELL",ea="CLICK_FOLLOW_BUTTON_UPSELL_MOBILE",en="INCREMENT_PIN_SAVE_COUNT",et="DECREMENT_PIN_SAVE_COUNT",eo="INCREMENT_UNAUTH_CLICKTHROUGH_COUNT",el="SET_UNAUTH_DOWNLOAD_COUNT",ei="UPS_EVENT_PIN_SAVE_MOBILE",er="SET_REFERRED_APP_UPSELL_STATE",es=e=>({type:Y,payload:{upsellEligibleNavigationCount:e}}),ed=e=>({type:_,payload:{upsellReason:e}}),eu=(e,a,n,t,o)=>({type:p,payload:{pinId:e,seoUrl:a,componentType:n,viewParameter:t,checkExperiment:o}}),e_=(e,a)=>({type:c,payload:{pinId:e,attributionLabel:a}}),ep=()=>({type:m}),ec=()=>({type:y}),eg=e=>({type:g,payload:{displayProps:e}}),em=()=>({type:L}),eh=(e,a,n)=>({type:T,payload:{pinId:e,attributionLabelSource:a,signupToLoginExpGroup:n}}),eS=(e,a)=>({type:N,payload:{isIdeaPin:e,isContextualFollowEnabled:a}}),eb=(e,a,n,t)=>({type:h,payload:{pinId:e,attributionLabelSource:a,signupToLoginExpGroup:n,checkExperiment:t}}),ew=({pinId:e,attributionLabelSource:a,downloadAllowedCallback:n})=>({checkExperiment:t,sessionContext:l})=>(l,i)=>{let d=i(),{limitReached:u,oldCount:_,newCount:p}=(0,s.H)(t,{downloadCount:d.upsell?.unauthDownloadCount??0,upsellDispatch:l,isAuthenticated:d.session?.isAuthenticated??!1});(0,o.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:a,limitReached:u,oldCount:_,newCount:p}),l({type:S,payload:{pinId:e,attributionLabelSource:a,limitReached:u,checkExperiment:t}}),r(i().upsell)||n()},ey=({pinId:e,attributionLabelSource:a,inImmediateUpsellGroup:n,inDwebSwapDownloadUpsellExp:t,downloadAllowedCallback:l,showDownloadIconForRelatedPins:i,inDwebDownloadCTAExp:d})=>({checkExperiment:u,sessionContext:_})=>(_,p)=>{let c=p(),{limitReached:g,oldCount:m,newCount:h}=(0,s.H)(u,{downloadCount:c.upsell?.unauthDownloadCount??0,upsellDispatch:_,isAuthenticated:c.session?.isAuthenticated??!1});i?(0,o.My)("dweb.unauth.action_bar.download_image",{attributionLabelSource:a,limitReached:g,oldCount:m,newCount:h}):d?(0,o.My)("dweb.unauth.download_cta.download_image",{attributionLabelSource:a}):t?(0,o.My)("dweb.unauth.swap_download_upsell.download_image",{attributionLabelSource:a}):(0,o.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:a,limitReached:g,oldCount:m,newCount:h}),_({type:f,payload:{pinId:e,attributionLabelSource:a,limitReached:g,inImmediateUpsellGroup:n,inDwebSwapDownloadUpsellExp:t,checkExperiment:u}}),r(p().upsell)||l()},ev=()=>({type:U}),eO=()=>({type:M}),eI=()=>({type:k}),eC=e=>({type:x,payload:{count:e}}),eE=()=>({type:R}),eP=(e,a)=>({checkExperiment:n,sessionContext:t})=>o=>{o({type:D,payload:{pageUniqueKey:e,containerPage:a,checkExperiment:n,sessionContext:t}})},eL=e=>({type:A,payload:{sessionContext:e}}),eT=e=>({type:G,payload:{l1Vertical:e}}),ef=(e,a)=>({type:q,payload:{inviter:e,containerPage:a}}),eN=e=>({checkExperiment:a})=>n=>{n({type:W,payload:{containerPage:e,checkExperiment:a}})},eU=e=>({checkExperiment:a})=>n=>{n({type:B,payload:{containerPage:e,checkExperiment:a}})},eM=()=>({type:O}),ek=()=>({checkExperiment:e})=>a=>{a({type:I,payload:{checkExperiment:e}})},ex=()=>({type:C}),eR=()=>({checkExperiment:e,sessionContext:a})=>n=>{let{group:t}=e?.("ce_mweb_unauth_social_feature_education")||{};t?.startsWith("enabled_group_board")?n((({checkExperiment:e})=>a=>{a({type:v,payload:{checkExperiment:e}})})({checkExperiment:e,sessionContext:a})):t?.startsWith("enabled_reply_to_sender")&&n((({checkExperiment:e})=>a=>{a({type:E,payload:{checkExperiment:e}})})({checkExperiment:e,sessionContext:a}))},eD=()=>({type:P}),eA=e=>({type:H,payload:e}),eG=()=>({type:V}),eF=e=>({type:$,payload:{topInterest:e}}),eq=()=>({type:K}),eW=()=>({type:Q}),eB=()=>({type:Z}),eH=e=>({checkExperiment:a,sessionContext:n})=>(t,l)=>{t({type:u,payload:{...e,checkExperiment:a,sessionContext:n}}),r(l().upsell)||(0,o.My)(`mweb.nav.upsell.show.${e.currentNavigationCount}`)},eV=e=>({checkExperiment:a,sessionContext:n})=>(r,s)=>{let u=s().upsell,{country:_,userAgent:p}=n,c=i.YM.mobile.shouldShowOnLandUpsell?.evaluate({checkExperiment:a,isUpsellEnabledGlobally:(0,l.e_)({isModalShown:u.mWebSignupModal.modal.isShown??!1,isUnauthSharingModalsShown:u.mWebSignupModal.isUnauthSharingModalsShown??!1,modalHasShown:!!u.mWebSignupModal.modalHasShown,country:_,userAgent:p}),hasSeenNavUpsell:u.mWebSignupModal.modalHasShown,location:e.location,isPaid:e.isPaid,isSocial:e.isSocial,isDirect:e.isDirect,isSEO:e.isSEO,userAgent:p,showUnauthMwebSocialDefaultModalUpsell:e.showUnauthMwebSocialDefaultModalUpsell,isSocialInAppBrowser:t.ry,session:n});c.shouldShowModal&&c.modalConfig&&((0,o.My)("mweb.nav.upsell.show.0"),c.showUnauthMwebSocialUpsell&&(0,d.nP)("unauth.mweb.social.pin.upsell",{sampleRate:1}),r({type:j,payload:{decision:c,checkExperiment:a}}))},e$=e=>({checkExperiment:a,sessionContext:n})=>(t,l)=>{let r=l().upsell,s=!!r.appUpsells.learningUpsell?.isShown,d=i.YM.mobile.shouldShowMainPinImageNavigationalModal?.evaluate({checkExperiment:a,session:n,isUpsellEnabledGlobally:e.upsellContext.isUpsellEnabledGlobally(),isModalCurrentlyShown:e.upsellContext.isModalShown,learningUpsellScenario:e.learningUpsellScenario}),u=i.YM.mobile.shouldShowMainPinImageAppUpsell?.evaluate({learningUpsellScenario:e.learningUpsellScenario,hasConversionUpsell:!!d,isLearningAppUpsellShown:s});d?(0,o.My)("mweb.nav.upsell.show.main_pin_image_click"):u.shouldToggleAppUpsell?u.currentlyShowing?e.trackInteraction({action:"dismiss",item:"learning-upsell"}):e.trackInteraction({action:"click",item:"learning-upsell"}):e.onImageClick(),t({type:X,payload:{conversionDecision:d,appUpsellDecision:u,checkExperiment:a,pinId:e.pinId}})},eK=({isShown:e,isDismissedByUser:a=!1})=>({type:J,payload:{isShown:e,isDismissedByUser:a}}),eQ=({pinId:e,attributionLabelSource:a,inImmediateUpsellGroup:n,inMwebDownloadCTAExp:t,showDownloadCloseupIcon:l,downloadAllowedCallback:i})=>({checkExperiment:d,sessionContext:u})=>(u,_)=>{let p=_(),{limitReached:c,oldCount:g,newCount:m}=(0,s.H)(d,{downloadCount:p.upsell?.unauthDownloadCount??0,upsellDispatch:u,isAuthenticated:p.session?.isAuthenticated??!1});t?(0,o.My)("mweb.unauth.download_cta.download_image",{attributionLabelSource:a}):l?(0,o.My)("mweb.unauth.download_closeup_icon.download_image",{attributionLabelSource:a}):(0,o.My)("mweb.unauth.context_menu.download_image",{attributionLabelSource:a,limitReached:c,oldCount:g,newCount:m}),u({type:z,payload:{pinId:e,attributionLabelSource:a,limitReached:c,inImmediateUpsellGroup:n,inMwebDownloadCTAExp:t,showDownloadCloseupIcon:l,checkExperiment:d}}),r(_().upsell)||i()},eZ=({isDismissedByUser:e=!1}={})=>({type:ee,payload:{isDismissedByUser:e}}),eY=(e,a)=>({type:ea,payload:{isIdeaPin:e,isContextualFollowEnabled:a}}),eX=()=>({type:et}),ej=()=>({type:eo}),eJ=e=>({type:el,payload:{count:e}}),ez=e=>({checkExperiment:a,sessionContext:n})=>(n,t)=>{let o=t().upsell;i.YM.mobile.shouldAllowUnauthSave?.evaluate({checkExperiment:a,isPPMAndroidUnauthExperience:e.isPPMAndroidUnauthExperience,isFromUnauthContextMenu:e.isFromUnauthContextMenu,currentUnauthSaves:e.unauthSavedPinsStore.pins.length})&&!o.mWebSignupModal.modal.isShown?(e.unauthSavedPinsStore.save({id:e.pinId,nodeId:e.nodeId,imageUrl:e.getPinGifOrImageSrc({imagesUrls:e.imagesUrls,embedSrc:e.embedSrc,embedType:e.embedType,excludeOriginals:!e.isBot&&!e.isSocialBot})}),n({type:en}),e.handleShowNavFooter(n,e.forceShowNavFooter,e.isNavBarHidden,e.setForceShowNavFooter),e.successCallback&&e.successCallback()):n({type:ei,payload:{attributionLabel:e.isFromUnauthContextMenu?e.attributionLabel||"click_save_button_on_closeup":"click_save_button_with_max_unauth_saves",headingType:e.isFromUnauthContextMenu?"save":"extended_save_out_of_quota",pinId:e.pinId,checkExperiment:a}})},e0=({isShown:e,appUpsellType:a,isBlocking:n})=>({type:er,payload:{isShown:e,appUpsellType:a,isBlocking:n}})},270922:function(e,a,n){n.d(a,{A4:()=>s,T9:()=>d,qo:()=>r,y1:()=>i});var t=n(95664),o=n(969809),l=n(238957);let i=e=>e?(0,o.Z)(e.toUpperCase()):"OTHER",r=e=>e.isPaid?"paid":e.isInvite?"invite":e.isSocial?"social":e.isSEO?"seo":e.utmSource?`utm_${e.utmSource}`:"direct",s=e=>e&&"string"==typeof e?(0,t.$K)(e)?"pinterest":(0,t.dh)(e)?"instagram":/wechat|micromessenger/i.test(e)?"wechat":(0,t.ry)(e)||/facebook|fbav|fban|tiktok|twitter|line/i.test(e)?"social":"none":"none",d=(e,a,t,o)=>{let d=e?.countryFromHostName||e?.country||"",u=e?.userAgent?.raw||("undefined"!=typeof navigator?navigator.userAgent:""),_=s(u),p=(e=>{let{isAnyTodayPage:a,isHubOrIdeaPage:t,isBoardSectionPage:o,isBoardPage:l,isCloseupPage:i,isHomePage:r,isSearchPage:s,isTopicPage:d}=n(173874),u=n(138482).Z,_={pathname:e};return a(_)?"today":t(_)?"ideas":o(_)?"section":l(_)?"board":i(_)?"closeup":r(_)?"home":u(_)?"profile":s(_)?"search":d(_)?"topic":""})(o),c=(0,l.iU)();return{country:d,userAgent:u,referrer:e?.referrerFromHeader||e?.referrerFromCookie||"",unauthID:e?.unauthId||"",region:i(d),channel:r(a),iab:_,isIAB:"instagram"===_||"wechat"===_||"social"===_,landingPageType:p,deviceType:t,revisitationState:c,revisitationCount:c.count,daysSinceLastVisit:(e=>{let{ts:a}=e;if(!a||0===a)return 0;let n=new Date,t=new Date(a);return Math.max(Math.floor(Number(((n.getTime()-t.getTime())/864e5).toFixed(2))),0)})(c)}}},986523:function(e,a,n){n.d(a,{Z:()=>r});var t=n(667294);let o=()=>()=>{},l=()=>!1,i=()=>!0,r=()=>(0,t.useSyncExternalStore)(o,l,i)},932921:function(e,a,n){n.d(a,{H:()=>i,Z:()=>l});var t=n(935833),o=n(671220);async function l({filename:e,imgSrc:a,imageDownloadSuccessCallback:n,category:o,pinId:l,viewParameter:i,viewType:r,isUnauth:s=!1,platform:d="web",expName:u,expGroup:_},p){return"undefined"==typeof window?Promise.resolve():((0,t.My)("web.download.click",{category:o||"no_category",authType:s?"unauth":"auth",platform:d,viewType:r,expName:u,expGroup:_}),p({event_type:82,object_id_str:l,view_type:r||3,view_parameter:i||139}),a&&document)?fetch(a,{headers:new Headers({Origin:window.location.origin}),mode:"cors"}).then(e=>e.blob()).then(a=>{let l=document.createElement("a");l.href=window.URL.createObjectURL(a),e&&l.setAttribute("download",e.replace(".","_")),l.style.display="none",document.body?.appendChild(l),l.click(),document.body?.removeChild(l),(0,t.My)("web.download.success",{category:o||"no_category",authType:s?"unauth":"auth",platform:d,viewType:r,expName:u,expGroup:_}),n?.()}).catch(()=>{throw(0,t.My)("web.download.failure",{category:o||"no_category",authType:s?"unauth":"auth",platform:d,viewType:r,expName:u,expGroup:_}),Error("Download image error")}):Promise.resolve()}let i=(e,a)=>{let{downloadCount:n=0,upsellDispatch:t,isAuthenticated:l,updateDownloadCount:i}=a||{};if(l)return{limitReached:!1,oldCount:0,newCount:0};if(e("unuath_download_paywalled").anyEnabled||e("unauth_combined_download_exp").anyEnabled)return{limitReached:!0,oldCount:0,newCount:0};let r=n>=1,s=r?n:n+1;return n!==s&&t&&(t((0,o.Dw)(s)),i?.()),{limitReached:r,oldCount:n,newCount:s}}},358198:function(e,a,n){n.d(a,{BW:()=>g,WW:()=>p});var t=n(686659),o=n(667294),l=n(15881),i=n(213491),r=n(501010),s=n(418282),d=n(767415),u=n(785893);let{Provider:_,getMaybe:p}=(0,i.Z)("CloseupNearDupSigsTracker"),c=({children:e})=>{(0,o.useEffect)(()=>{(0,t.Z)("CloseupNearDupSigsTrackerContext","/app/www/closeup/CloseupNearDupSigsTrackerContext.tsx")},[]);let a=(0,s.Nl)(),n=(0,o.useRef)([]),i=(0,o.useRef)(new Set),r=(0,o.useRef)([]),p=(0,o.useRef)(new Set),c=(0,o.useRef)([null,[]]),g=(0,o.useCallback)(()=>{a.setItem(l.S4,n.current),a.setItem(l.yb,r.current)},[a]),m=(0,o.useCallback)(()=>{let e=a.getItem(l.S4),t=a.getItem(l.yb);if(e)try{Array.isArray(e)&&e.every(e=>"string"==typeof e)&&(n.current=e.slice(-5),i.current=new Set(n.current))}catch(e){(0,d.nP)("closeup_page.near_dup.session_storage_sync.closeup.fail",{sampleRate:1})}if(t)try{Array.isArray(t)&&t.every(e=>"string"==typeof e)&&(r.current=t.slice(-35),p.current=new Set(r.current))}catch(e){(0,d.nP)("closeup_page.near_dup.session_storage_sync.impression.fail",{sampleRate:1})}},[n,r,a]),h=(0,o.useCallback)(e=>{if(p.current.has(e)&&(r.current=r.current.filter(a=>a!==e)),r.current.length>=35){let e=r.current.shift();e&&p.current.delete(e)}p.current.add(e),r.current.push(e)},[]),S=(0,o.useCallback)(e=>{if(i.current.has(e)&&(n.current=n.current.filter(a=>a!==e)),n.current.length>=5){let e=n.current.shift();e&&i.current.delete(e)}i.current.add(e),n.current.push(e),g()},[g]),b=(0,o.useCallback)(e=>{let[a,t]=c.current;if(a===e)return t;0===n.current.length&&0===r.current.length&&m();let o=Array.from(new Set([...r.current,...n.current]));return c.current=[e,o],o},[m]);(0,o.useEffect)(()=>g,[g]);let w=(0,o.useMemo)(()=>({addImpression:h,addCloseup:S,getTrackedNearDupSigs:b}),[h,S,b]);return(0,u.jsx)(_,{value:w,children:e})},g=({children:e})=>{(0,o.useEffect)(()=>{(0,t.Z)("CloseupNearDupSigsTrackerContext","/app/www/closeup/CloseupNearDupSigsTrackerContext.tsx")},[]);let{checkExperiment:a}=(0,r.Z)();return a("web_closeup_rabbit_hole_dedup").anyEnabled?(0,u.jsx)(c,{children:e}):(0,u.jsx)(_,{value:void 0,children:e})}},2061:function(e,a,n){n.d(a,{Yg:()=>s,ib:()=>u,nF:()=>p,xX:()=>_});var t=n(501010),o=n(774838),l=n(739405),i=n(767415);let r=({checkExperiment:e})=>{let{group:a}=e("auth_mweb_graphql_pin_page",{dangerouslySkipActivation:!0});return{logStat:(e,n)=>(0,i.nP)("webapp.graphql.debug_auth_mweb_graphql_pin_page",{sampleRate:1,tags:{event:e,group:a,...n}})}},s=()=>{let{isAuthenticated:e}=(0,o.B)(),a=(0,l.HG)(),{checkExperiment:n}=(0,t.Z)();return e&&!a?r({checkExperiment:n}):{logStat:()=>{}}},d=0,u=({checkExperiment:e,isAuthMweb:a})=>{if(!a)return;let{logStat:n}=r({checkExperiment:e});(d+=1)<10&&n(`repin_${d}`)};function _({checkExperiment:e,isDesktop:a,isAuthenticated:n}){if(!n)return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!0,shouldPrefetchCloseupPreviewFragment:!1};if(a){let{anyEnabled:a}=e("auth_dweb_graphql_pin_page");return{isGraphQLEnabledForRelatedPins:a,isGraphQLEnabledInGeneral:a,shouldPrefetchCloseupPreviewFragment:!1}}{let{anyEnabled:a,group:n}=e("auth_mweb_graphql_pin_page");switch(n){case"control":return{isGraphQLEnabledInGeneral:!1,isGraphQLEnabledForRelatedPins:!1,shouldPrefetchCloseupPreviewFragment:!1};case"enabled":return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!0,shouldPrefetchCloseupPreviewFragment:!1};case"enabled_prefetch_closeup_data":return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!0,shouldPrefetchCloseupPreviewFragment:!0};case"only_closeup":return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!1,shouldPrefetchCloseupPreviewFragment:!1};case"only_related_pins":return{isGraphQLEnabledInGeneral:!1,isGraphQLEnabledForRelatedPins:!0,shouldPrefetchCloseupPreviewFragment:!1};default:return{isGraphQLEnabledInGeneral:a,isGraphQLEnabledForRelatedPins:a,shouldPrefetchCloseupPreviewFragment:!1}}}}function p(){let{checkExperiment:e}=(0,t.Z)(),a=(0,l.HG)(),{isAuthenticated:n}=(0,o.B)();return _({checkExperiment:e,isDesktop:a,isAuthenticated:n})}},163691:function(e,a,n){n.d(a,{Z:()=>t});let t=function(e){return{...e,ts:Date.now()}}},238957:function(e,a,n){n.d(a,{K7:()=>s,Vd:()=>u,WT:()=>r,iU:()=>d});var t=n(4533),o=n(994507),l=n(34550),i=n(163691);let r=18e5,s=o.dm,d=()=>{try{let{count:e,time:a,ts:n}=(0,l.M0)().getItem(t.SI)??{};if("number"==typeof e&&"number"==typeof a&&"number"==typeof n)return{count:e,time:a,ts:n};throw Error("Invalid revisitation data")}catch(e){return(0,o.dm)()}},u=e=>{(0,l.M0)().setItem(t.SI,(0,i.Z)(e))}},658375:function(e,a,n){n.d(a,{C:()=>i,P:()=>l});var t=n(173874),o=n(767415);let l=()=>!1,i=e=>{(0,t.isDiscoverArticlePage)(e)&&!l()&&(0,o.nP)("mobile_signup_modal.rules.suppress_for_discover_article",{flushImmediate:!0,sampleRate:1})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/51723-b905a98141fff8c2.mjs.map